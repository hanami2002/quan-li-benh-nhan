<%-- 
    Document   : home
    Created on : May 20, 2023, 3:47:43 PM
    Author     : Hanami
--%>
<%@taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<%@page contentType="text/html" pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Qu·∫£n l√≠ b·ªánh nh√¢n</title>
        <c:if test="${sessionScope.user==null}">
            <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css"> 
        </c:if>
        <jsp:useBean id="dateUtils" scope="page" class="utils.DateExp" />
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
        <script >
            function deletepaitnet(pid) {
                if (confirm("Do you want to delete?")) {
                    window.location = "deletepaitnet?pid=" + pid;
                }
            }
        </script>
    </head>
    <body>
        <c:if test="${sessionScope.user==null}">
            <style>
                body{
                    background-color: black;
                    color: white;
                }

                h1 {
                    color: red;
                }

                h6{
                    color: red;
                    text-decoration: underline;
                }
            </style>
            <div class="w3-display-middle">
                <h1 class="w3-jumbo w3-animate-top w3-center"><code>Access Denied</code></h1>
                <hr class="w3-border-white w3-animate-left" style="margin:auto;width:50%">
                <h3 class="w3-center w3-animate-right">You dont have permission to view this site.</h3>
                <h3 class="w3-center w3-animate-zoom">üö´üö´üö´üö´</h3>
                <a href="login.jsp"><h6 class="w3-center w3-animate-zoom">Back to login</h6></a>
            </div>
        </c:if>
        <c:if test="${sessionScope.user!=null}">
            <style>
                body {
                    font-family: Arial, sans-serif;
                    margin: 0;
                    padding: 0;
                }

                header {
                    background-color: #f5f5f5;
                    padding: 20px;
                }

                h1 {
                    margin: 0;
                    color: #333;
                }

                nav ul {
                    list-style-type: none;
                    margin: 0;
                    padding: 0;
                    background-color: #333;
                }

                nav ul li {
                    display: inline-block;
                    margin-right: 10px;
                }

                nav ul li a {
                    display: block;
                    color: #fff;
                    text-decoration: none;
                    padding: 10px;
                }

                section {
                    padding: 20px;
                }

                h2 {
                    margin-top: 0;
                }

                table {
                    width: 100%;
                    border-collapse: collapse;
                }

                th, td {
                    padding: 10px;
                    border: 1px solid #ccc;
                }

                footer {
                    background-color: #f5f5f5;
                    padding: 20px;
                    text-align: center;
                }

            </style>
            <header>
                <h1>B·ªánh vi·ªán XYZ</h1>

                <h2>Xin ch√†o ${sessionScope.user.getDisplayname()}</h2>
            </header>
            <div >
                <nav >
                    <ul>

                        <li>
                            <button id="add-patient" type="button" class="btn btn-primary" data-toggle="modal" data-target="#addPatientModal">
                                Th√™m b·ªánh nh√¢n
                            </button>
                        </li>
                        <li>
                            <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#addDiagnosisModal">
                                Th√™m chu·∫©n ƒëo√°n
                            </button>
                        </li>
                        <li><button type="button" class="btn btn-primary" data-toggle="modal" data-target="#patientHistoryModal">
                                L·ªãch s·ª≠ b·ªánh nh√¢n
                            </button></li>
                        <li><a href="#">Th√¥ng tin b·ªánh vi·ªán</a></li>
                        <li><a href="list">
                                <button type="button" class="btn btn-primary" >
                                    L·ªãch s·ª≠ chu·∫©n ƒëo√°n
                                </button></a>
                        </li>
                        <li>
                            <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#updateInformation">
                                Thay ƒë·ªïi th√¥ng tin
                            </button>
                        </li>
                        <li>
                            <a href="logout"><button type="button" class="btn btn-primary" >
                                    ƒêƒÉng xu·∫•t
                                </button></a>
                        </li>
                    </ul>
                </nav>
            </div>
            <section>
                <h2>Danh s√°ch b·ªánh nh√¢n</h2>
                <div class="container">
                    <table>
                        <thead>
                            <tr>
                                <th style="width:10rem">M√£ B·ªánh Nh√¢n</th>
                                <th>T√™n</th>
                                <th>ƒê·ªãa ch·ªâ</th>
                                <th>Ng√†y sinh</th>
                                <th>ƒêi·ªán tho·∫°i</th>
                                <th style="width: 15rem;">Thao t√°c</th>

                            </tr>
                        </thead>
                        <tbody>
                            <c:forEach var="p" items="${listP}">
                                <tr>
                                    <td>${p.getId()}</td>
                                    <td>${p.getName()}</td>
                                    <td>${p.getAddress()}</td>
                                    <td>${dateUtils.convertDate(p.getDob())}</td>
                                    <td>${p.getContact()}</td>
                                    <td>
                                        <a onclick="deletepaitnet('${p.getId()}')" href="#"><button type="button" class="btn btn-primary" >
                                                X√≥a
                                            </button></a>
                                        <button type="button" class="btn btn-primary edit-button" data-toggle="modal" data-target="#addPatientModal"
                                                data-patient='${p.toJSON()}'>
                                            S·ª≠a th√¥ng tin
                                        </button>
                                    </td>
                                </tr>       
                            </c:forEach>
                        </tbody>
                    </table>
                </div>
            </section>
            <!-- Modal th√™m b·ªánh nh√¢n -->
            <div class="modal fade" id="addPatientModal" tabindex="-1" role="dialog" aria-labelledby="addPatientModalLabel"
                 aria-hidden="true">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="addPatientModalLabel">Th√™m b·ªánh nh√¢n</h5>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                        <form action="addpaitnet" method="post">
                            <div class="modal-body">

                                <input type="text" name="pcreate" value="${sessionScope.user.getUsername()}" hidden>
                                <input type="text" name="pid" class="form-control" id="inputId" hidden >
                                <div class="form-group">
                                    <label for="inputName">T√™n b·ªánh nh√¢n:</label>
                                    <input type="text" name="pname" class="form-control" id="inputName" placeholder="Nh·∫≠p t√™n b·ªánh nh√¢n">
                                </div>
                                <div class="form-group">
                                    <label for="inputDOB">Ng√†y sinh:</label>
                                    <input type="date" name="pdob" class="form-control" id="inputDOB">
                                </div>
                                <div class="form-group">
                                    <label for="inputAddress">ƒê·ªãa ch·ªâ:</label>
                                    <input type="text" name="paddress" class="form-control" id="inputAddress" placeholder="Nh·∫≠p ƒë·ªãa ch·ªâ">
                                </div>
                                <div class="form-group">
                                    <label for="inputPhone">S·ªë ƒëi·ªán tho·∫°i:</label>
                                    <input type="tel" name="pphone" class="form-control" id="inputPhone" placeholder="Nh·∫≠p s·ªë ƒëi·ªán tho·∫°i">
                                </div>

                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-dismiss="modal">ƒê√≥ng</button>
                                <button type="submit" name="btn" value="Add" class="btn btn-primary">Th√™m</button>
                                <button type="submit" name="btn" value="Edit" class="btn btn-primary">S·ª≠a</button>
                            </div></form>
                    </div>
                </div>
            </div>
            <!-- Modal th√™m chu·∫©n ƒëo√°n -->
            <div class="modal fade" id="addDiagnosisModal" tabindex="-1" role="dialog" aria-labelledby="addDiagnosisModalLabel"
                 aria-hidden="true">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="addDiagnosisModalLabel">Th√™m chu·∫©n ƒëo√°n</h5>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                        <form action="addDiagnostic" method="post">
                            <div class="modal-body">
                                <input hidden type="text" name="pcreate" value="${sessionScope.user.getUsername()}" >

                                <div class="form-group">
                                    <label for="inputPatient">M√£ s·ªë b·ªánh nh√¢n:</label>
                                    <input type="text" name="pid" class="form-control " id="inputPatient" placeholder="Nh·∫≠p m√£ s·ªë b·ªánh nh√¢n">
                                </div>
                                <div class="form-group">
                                    <label for="inputSymptoms">Tri·ªáu ch·ª©ng:</label>
                                    <textarea name="symptom" class="form-control form-control-lg" id="inputSymptoms" rows="2" placeholder="Nh·∫≠p tri·ªáu ch·ª©ng"></textarea>
                                </div>
                                <div class="form-group">
                                    <label for="inputDiagnosis">Chu·∫©n ƒëo√°n:</label>
                                    <textarea name="diagnosis"class="form-control form-control-lg" id="inputDiagnosis" rows="2" placeholder="Nh·∫≠p chu·∫©n ƒëo√°n"></textarea>
                                </div>
                                <div class="form-group">
                                    <label for="inputMedication">Thu·ªëc:</label>
                                    <textarea name="medication" class="form-control form-control-lg" id="inputMedication" rows="2" placeholder="Nh·∫≠p thu·ªëc"></textarea>
                                </div>
                                <div class="form-group">
                                    <div class="form-check">
                                        <input name="admitted" class="form-check-input" type="checkbox" id="inputAdmitted">
                                        <label class="form-check-label" for="inputAdmitted">
                                            Ph·∫£i nh·∫≠p vi·ªán
                                        </label>
                                    </div>
                                </div>


                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-dismiss="modal">ƒê√≥ng</button>
                                <button type="submit" class="btn btn-primary">Th√™m</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            <!-- The modal history -->
            <div class="modal fade" id="patientHistoryModal" tabindex="-1" role="dialog" aria-labelledby="patientHistoryModalLabel" aria-hidden="true">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="patientHistoryModalLabel">L·ªãch s·ª≠ b·ªánh nh√¢n</h5>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                        <div class="modal-body">
                            <form>
                                <div class="form-group">
                                    <label for="searchPatientInput">T√¨m ki·∫øm theo t√™n</label>
                                    <input type="text" class="form-control" id="searchPatientInput" placeholder="Nh·∫≠p t√™n b·ªánh nh√¢n">
                                </div>
                            </form>
                            <div id="patientInfo">
                                <!-- T√™n b·ªánh nh√¢n v√† b·∫£ng hi·ªÉn th·ªã c√°c chu·∫©n ƒëo√°n s·∫Ω ƒë∆∞·ª£c hi·ªÉn th·ªã t·∫°i ƒë√¢y -->
                            </div>
                            <table class="table">
                                <thead>
                                    <tr>
                                        <th>Ng√†y</th>
                                        <th>Tri·ªáu ch·ª©ng</th>
                                        <th>Chu·∫©n ƒëo√°n</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Ng√†y 1</td>
                                        <td>Tri·ªáu ch·ª©ng 1</td>
                                        <td>Chu·∫©n ƒëo√°n 1</td>
                                    </tr>
                                    <tr>
                                        <td>Ng√†y 2</td>
                                        <td>Tri·ªáu ch·ª©ng 2</td>
                                        <td>Chu·∫©n ƒëo√°n 2</td>
                                    </tr>
                                    <!-- Th√™m c√°c h√†ng d·ªØ li·ªáu chu·∫©n ƒëo√°n tr∆∞·ªõc ƒë√≥ t·∫°i ƒë√¢y -->
                                </tbody>
                            </table>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-dismiss="modal">ƒê√≥ng</button>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Modal -->
            <div class="modal fade" id="updateInformation" tabindex="-1" role="dialog" aria-labelledby="updateInformationLabel" aria-hidden="true">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="updateInformationLabel">Thay ƒë·ªïi th√¥ng tin</h5>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                        <div class="modal-body">
                            <form>
                                <div class="form-group">
                                    <label for="displayName">T√™n hi·ªÉn th·ªã:</label>
                                    <input type="text" class="form-control" id="displayName" placeholder="Nh·∫≠p t√™n hi·ªÉn th·ªã">
                                </div>
                                <div class="form-group">
                                    <label for="password">M·∫≠t kh·∫©u:</label>
                                    <input type="password" class="form-control" id="password" placeholder="Nh·∫≠p m·∫≠t kh·∫©u">
                                </div>
                                <div class="form-group">
                                    <label for="password">Nh·∫≠p l·∫°i m·∫≠t kh·∫©u:</label>
                                    <input type="password" class="form-control" id="re-password" placeholder="Nh·∫≠p l·∫°i m·∫≠t kh·∫©u">
                                </div>
                            </form>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-dismiss="modal">ƒê√≥ng</button>
                            <button type="button" class="btn btn-primary" id="saveChangesBtn">L∆∞u thay ƒë·ªïi</button>
                        </div>
                    </div>
                </div>
            </div>
            <footer>
                <p>&copy; 2023 B·ªánh vi·ªán XYZ. All rights reserved.</p>
            </footer>

            <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
            <script>

                                            $(document).ready(function () {
                                                $("#add-patient").click(() => {
                                                    $("#inputName").val("");
                                                    $("#inputDOB").val("");
                                                    $("#inputAddress").val("");
                                                    $("#inputPhone").val("");
                                                    $("button[value='Edit']").hide();
                                                    $("button[value='Add']").show();
                                                });
                                                // X·ª≠ l√Ω s·ª± ki·ªán nh·∫•n n√∫t "S·ª≠a th√¥ng tin"
                                                $(".edit-button").click(function () {
                                                    $("button[value='Edit']").show();
                                                    $("button[value='Add']").hide();
                                                    const patient = $(this).data("patient");
                                                    console.log(patient);
                                                    // L·∫•y th√¥ng tin b·ªánh nh√¢n t·ª´ thu·ªôc t√≠nh data-patient
                                                    // var patient = JSON.parse($(this).data("patient"));
                                                    // ƒê·∫©y th√¥ng tin b·ªánh nh√¢n v√†o modal "Th√™m b·ªánh nh√¢n"
                                                    $("#inputId").val(patient.id);
                                                    $("#inputName").val(patient.name);
                                                    $("#inputDOB").val(dateFormat(patient.dob));
                                                    $("#inputAddress").val(patient.address);
                                                    $("#inputPhone").val(patient.contact);
                                                });
                                            });
                                            const month = {
                                                "Jan": 1,
                                                "Feb": 2,
                                                "Mar": 3,
                                                "Apr": 4,
                                                "May": 5,
                                                "Jun": 6,
                                                "Jul": 7,
                                                "Aug": 8,
                                                "Sep": 9,
                                                "Oct": 10,
                                                "Nov": 11,
                                                "Dec": 12
                                            };
                                            const dateFormat = (date = "Jan 1, 2020") => {
                                                date = date.replace(",", "").split(" ")

                                                return date[2] + "-" + (Number(month[date[0]]) / 10 >= 1 ? month[date[0]] : ("0" + month[date[0]])) + "-" + (Number(date[1]) / 10 >= 1 ? date[1] : ("0" + date[1]));
                                            };
                                            console.log(dateFormat("Dec 13, 2002"));


            </script>
        </c:if>


    </body>
</html>

